
{% extends 'base.html' %}
{% load music_filters %}

{% block title %}SoundWave Pro - Home{% endblock %}

{% block extra_styles %}
<style>
    .hero-section {
        padding: 1.2rem;
        margin-bottom: 1.5rem;
        position: relative;
        overflow: hidden;
    }

    .hero-carousel {
        position: relative;
        height: 16rem;
        border-radius: 1.2rem;
        overflow: hidden;
        box-shadow: var(--shadow-heavy);
    }

    .hero-slide {
        position: absolute;
        width: 100%;
        height: 100%;
        opacity: 0;
        transition: opacity 0.8s ease-in-out;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1.5rem;
        color: white;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
    }

    .hero-slide::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 0;
    }

    .hero-slide.active {
        opacity: 1;
    }

    .hero-content {
        position: relative;
        z-index: 1;
    }

    .hero-content h1 {
        font-size: clamp(1.5rem, 3.5vw, 2rem);
        font-weight: 800;
        margin-bottom: 0.6rem;
        line-height: 1.1;
    }

    .hero-content p {
        font-size: clamp(0.8rem, 1.8vw, 0.9rem);
        opacity: 0.9;
        margin-bottom: 1.2rem;
        max-width: 28rem;
    }

    .hero-cta {
        padding: 0.6rem 1.2rem;
        background: rgba(255, 255, 255, 0.2);
        border: 0.1rem solid rgba(255, 255, 255, 0.3);
        border-radius: 1.2rem;
        color: white;
        font-weight: 600;
        font-size: 0.8rem;
        cursor: pointer;
        transition: all 0.3s ease;
        backdrop-filter: blur(0.5rem);
        text-decoration: none;
    }

    .hero-cta:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-0.1rem);
    }

    .hero-visual {
        font-size: clamp(4rem, 8vw, 6rem);
        opacity: 0.3;
        animation: float 6s ease-in-out infinite;
        position: relative;
        z-index: 1;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-1rem); }
    }

    .carousel-dots {
        position: absolute;
        bottom: 1rem;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 0.6rem;
    }

    .dot {
        width: 0.6rem;
        height: 0.6rem;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.4);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .dot.active {
        background: white;
        transform: scale(1.2);
    }

    .content {
        padding: 0 1.2rem 1.5rem;
        flex: 1;
    }

    .section {
        margin-bottom: 2rem;
    }

    .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1rem;
    }

    .section-title {
        font-size: clamp(1rem, 2.5vw, 1.5rem);
        font-weight: 800;
        color: var(--text-primary);
    }

    .see-all {
        color: var(--accent-primary);
        font-weight: 600;
        font-size: 0.8rem;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .see-all:hover {
        color: var(--accent-secondary);
    }

    .music-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(10rem, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
    }

    .music-card {
        background: var(--bg-card);
        border-radius: 1rem;
        padding: 0.8rem;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        cursor: pointer;
        position: relative;
        overflow: hidden;
        border: 1px solid var(--border-color);
        backdrop-filter: blur(0.5rem);
    }

    .music-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--accent-gradient);
        opacity: 0;
        transition: opacity 0.3s ease;
        z-index: -1;
    }

    .music-card:hover {
        transform: translateY(-0.4rem) scale(1.02);
        box-shadow: var(--shadow-heavy);
        background: var(--bg-card-hover);
    }

    .music-card:hover::before {
        opacity: 0.05;
    }

    .music-cover {
        width: 100%;
        aspect-ratio: 1;
        border-radius: 0.8rem;
        background: var(--accent-gradient);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        color: white;
        margin-bottom: 0.6rem;
        position: relative;
        overflow: hidden;
    }

    .music-cover::after {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
        transform: translateX(-100%);
        transition: transform 0.6s ease;
    }

    .music-card:hover .music-cover::after {
        transform: translateX(100%);
    }

    .music-info {
        text-align: center;
    }

    .music-title {
        font-weight: 700;
        font-size: 0.85rem;
        margin-bottom: 0.2rem;
        color: var(--text-primary);
    }

    .music-artist {
        color: var(--text-secondary);
        font-size: 0.8rem;
        font-weight: 500;
    }

    .play-btn {
        position: absolute;
        top: 50%;
        right: 0.8rem;
        transform: translateY(-50%) scale(0);
        background: var(--accent-primary);
        border: none;
        border-radius: 50%;
        width: 2rem;
        height: 2rem;
        color: white;
        font-size: 0.9rem;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        box-shadow: var(--shadow-light);
    }

    .music-card:hover .play-btn {
        transform: translateY(-50%) scale(1);
    }

    .play-btn:hover {
        background: var(--accent-secondary);
        transform: translateY(-50%) scale(1.1);
    }

    .track-list {
        background: var(--bg-card);
        border-radius: 1rem;
        overflow: hidden;
        border: 1px solid var(--border-color);
        backdrop-filter: blur(0.5rem);
    }

    .track-header {
        display: grid;
        grid-template-columns: 3rem 1fr 6rem 3rem;
        gap: 0.6rem;
        padding: 0.6rem 1.2rem;
        border-bottom: 1px solid var(--border-color);
        font-size: 0.7rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        color: var(--text-muted);
    }

    .track-item {
        display: grid;
        grid-template-columns: 3rem 1fr 6rem 3rem;
        gap: 0.6rem;
        padding: 0.6rem 1.2rem;
        border-bottom: 1px solid var(--border-color);
        cursor: pointer;
        transition: all 0.3s ease;
        align-items: center;
    }

    .track-item:last-child {
        border-bottom: none;
    }

    .track-item:hover {
        background: var(--bg-card-hover);
    }

    .track-number {
        text-align: center;
        font-weight: 600;
        color: var(--text-secondary);
        font-size: 0.8rem;
    }

    .track-info {
        display: flex;
        flex-direction: column;
        gap: 0.2rem;
    }

    .track-title {
        font-weight: 600;
        color: var(--text-primary);
        font-size: 0.85rem;
    }

    .track-artist {
        font-size: 0.8rem;
        color: var(--text-secondary);
    }

    .track-duration {
        text-align: center;
        color: var(--text-secondary);
        font-weight: 500;
        font-size: 0.8rem;
    }

    .download-btn {
        background: none;
        border: none;
        color: var(--text-secondary);
        cursor: pointer;
        padding: 0.4rem;
        border-radius: 0.4rem;
        transition: all 0.3s ease;
        font-size: 0.9rem;
    }

    .download-btn:hover {
        color: var(--accent-primary);
        background: var(--bg-card);
    }

    .share-btn {
        background: var(--bg-card);
        border: none;
        color: var(--text-primary);
        cursor: pointer;
        padding: 0.4rem;
        border-radius: 50%;
        transition: all 0.3s ease;
        width: 1.8rem;
        height: 1.8rem;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-left: 0.4rem;
    }

    .share-btn:hover {
        background: var(--accent-primary);
        color: white;
        transform: scale(1.1);
    }

    .music-card .share-btn {
        position: absolute;
        top: 0.8rem;
        right: 0.8rem;
        transform: scale(0);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .music-card:hover .share-btn {
        transform: scale(1);
    }

    .track-item .track-actions {
        display: flex;
        align-items: center;
        gap: 0.4rem;
    }

    @keyframes slideInUp {
        from {
            transform: translateY(1.5rem);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @keyframes slideInRight {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 0.95;
        }
    }

    @keyframes slideOutRight {
        from {
            transform: translateX(0);
            opacity: 0.95;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }

    .music-card {
        animation: slideInUp 0.6s ease-out;
    }

    .track-item {
        animation: fadeIn 0.4s ease-out;
    }

    .hidden {
        display: none !important;
    }

    .playing .current-cover {
        animation: pulse 2s infinite;
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    @media (max-width: 75rem) {
        .music-grid {
            grid-template-columns: repeat(auto-fill, minmax(9rem, 1fr));
        }
    }

    @media (max-width: 60.5rem) {
        .hero-content h1 {
            font-size: clamp(1.25rem, 3vw, 1.75rem);
        }

        .music-grid {
            grid-template-columns: repeat(auto-fill, minmax(8rem, 1fr));
            gap: 0.8rem;
        }

        .player {
            grid-template-columns: 11rem 1fr 8rem;
            padding: 0 0.6rem;
        }

        .track-header,
        .track-item {
            grid-template-columns: 2rem 1fr 4rem 2rem;
            padding: 0.6rem;
        }
    }

    @media (max-width: 40rem) {
        .content {
            padding: 0 0.6rem 1.5rem;
        }

        .hero-section {
            padding: 0.6rem;
        }

        .hero-slide {
            padding: 1.2rem 0.8rem;
            flex-direction: column;
            text-align: center;
        }

        .hero-content h1 {
            font-size: clamp(1rem, 2.5vw, 1.5rem);
        }

        .hero-visual {
            font-size: clamp(2.5rem, 7vw, 3.5rem);
            margin-top: 0.6rem;
        }

        .music-grid {
            grid-template-columns: repeat(auto-fill, minmax(7rem, 1fr));
            gap: 0.6rem;
        }

        .player {
            grid-template-columns: 1fr;
            height: auto;
            padding: 0.6rem;
        }

        .player-left {
            justify-content: center;
            margin-bottom: 0.6rem;
        }

        .player-right {
            justify-content: center;
            margin-top: 0.6rem;
        }

        .section-title {
            font-size: clamp(0.9rem, 2vw, 1rem);
        }

        .track-header {
            display: none;
        }

        .track-item {
            grid-template-columns: 1fr auto;
            gap: 0.6rem;
        }

        .track-number,
        .download-btn {
            display: none;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="hero-section">
    <div class="hero-carousel" id="heroCarousel">
        <div class="hero-slide active" style="background-image: url('https://w0.peakpx.com/wallpaper/260/859/HD-wallpaper-malawian-metal-flag-grunge-art-african-countries-day-of-malawi-national-symbols-malawi-flag-metal-flags-flag-of-malawi-africa-malawian-flag-malawi.jpg');">
            <div class="hero-content">
                <h1>Discover Amazing Music</h1>
                <p>Explore millions of songs from your favorite artists and discover new ones tailored just for you.</p>
                <button class="hero-cta">Start Listening</button>
            </div>
            <div class="hero-visual">
                <span class="material-icons">music_note</span>
            </div>
        </div>
        <div class="hero-slide" style="background-image: url('https://cdn.dribbble.com/userupload/42463813/file/original-00945ba2db181dd1f345d1b2436dc2d7.gif');">
            <div class="hero-content">
                <h1>Your Music, Your Way</h1>
                <p>Upload your personal collection and enjoy high-quality streaming with advanced controls.</p>
                <a href="{% url 'upload_song' %}" class="hero-cta">Upload Now</a>
            </div>
            <div class="hero-visual">
                <span class="material-icons">library_music</span>
            </div>
        </div>
        <div class="hero-slide" style="background-image: url('https://watercolorartsa.com/wp-content/uploads/2024/01/madalitso-108jpg.png-56.jpg');">
            <div class="hero-content">
                <h1>Premium Experience</h1>
                <p>Enjoy ad-free listening, offline downloads, and crystal-clear audio quality.</p>
                <button class="hero-cta">Go Premium</button>
            </div>
            <div class="hero-visual">
                <span class="material-icons">star</span>
            </div>
        </div>
    </div>
    <div class="carousel-dots">
        <div class="dot active" data-slide="0"></div>
        <div class="dot" data-slide="1"></div>
        <div class="dot" data-slide="2"></div>
    </div>
</div>

<div class="content">
    <div class="section">
        <div class="section-header">
            <h2 class="section-title">Latest Songs</h2>
            <span class="see-all">See all</span>
        </div>
        <div class="music-grid" id="musicGrid">
            {% for song in songs|slice:":6" %}
            <div class="music-card" style="animation-delay: {{ forloop.counter0|div:10 }}s;" data-index="{{ forloop.counter0 }}">
                {% if song.cover_image %}
                <div class="music-cover">
                    <img src="{{ song.cover_image.url }}" alt="Cover" style="width: 100%; height: 100%; object-fit: cover;">
                </div>
                {% else %}
                <div class="music-cover" style="background: linear-gradient(135deg, #ff6b6b 0%, #feca57 {{ forloop.counter0|div:6|add:'1' }}%)">
                    <span class="material-icons">music_note</span>
                </div>
                {% endif %}
                <div class="music-info">
                    <div class="music-title">{{ song.title }}</div>
                    <div class="music-artist">{{ song.artist.user.username }}</div>
                </div>
                <button class="play-btn" data-index="{{ forloop.counter0 }}">
                    <span class="material-icons">play_arrow</span>
                </button>
                <button class="share-btn" data-platform="webshare" data-url="{% url 'song_detail' song.id %}" data-title="{{ song.title }} by {{ song.artist.user.username }}">
                    <span class="material-icons">share</span>
                </button>
            </div>
            {% empty %}
            <p>No songs available.</p>
            {% endfor %}
        </div>
    </div>

    <div class="section">
        <div class="section-header">
            <h2 class="section-title">All Songs</h2>
            <span class="see-all">View playlist</span>
        </div>
        <div class="track-list">
            <div class="track-header">
                <div>#</div>
                <div>Title</div>
                <div>Genre</div>
                <div></div>
            </div>
            <div id="trackList">
                {% for song in songs %}
                <div class="track-item" style="animation-delay: {{ forloop.counter0|div:20 }}s;" data-index="{{ forloop.counter0 }}">
                    <div class="track-number">{{ forloop.counter }}</div>
                    <div class="track-info">
                        <div class="track-title">{{ song.title }}</div>
                        <div class="track-artist">{{ song.artist.user.username }}</div>
                    </div>
                    <div class="track-duration">{{ song.genre }}</div>
                    <div class="track-actions">
                        <a href="{% url 'download_song' song.id %}" class="download-btn" title="Download">
                            <span class="material-icons">download</span>
                        </a>
                        <button class="share-btn" data-platform="webshare" data-url="{% url 'song_detail' song.id %}" data-title="{{ song.title }} by {{ song.artist.user.username }}">
                            <span class="material-icons">share</span>
                        </button>
                    </div>
                </div>
                {% empty %}
                <div class="track-item">No songs available.</div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}