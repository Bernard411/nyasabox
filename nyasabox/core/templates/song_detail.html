{% extends 'base.html' %}
{% load static %}

{% block title %}{{ song.title }} - SoundWave Pro{% endblock %}

{% block content %}
<div class="content">
    <div class="section">
        <div class="song-detail">
            {% if song.cover_image %}
            <div class="song-cover" style="width: 200px; height: 200px; flex-shrink: 0;">
                <img src="{{ song.cover_image.url }}" alt="{{ song.title }}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 1rem;">
            </div>
            {% else %}
            <div class="song-cover" style="width: 200px; height: 200px; flex-shrink: 0; background: var(--accent-gradient); display: flex; align-items: center; justify-content: center; border-radius: 1rem;">
                <span class="material-icons" style="font-size: 4rem; color: white;">music_note</span>
            </div>
            {% endif %}
            
            <div class="song-info">
                <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">{{ song.title }}</h1>
                <p style="color: var(--text-secondary); font-size: 1.2rem; margin-bottom: 1rem;">by {{ song.artist.user.username }}</p>
                
                <div style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                    <span style="background: var(--bg-card); padding: 0.5rem 1rem; border-radius: 2rem; font-size: 0.9rem;">{{ song.genre }}</span>
                    <span style="background: var(--bg-card); padding: 0.5rem 1rem; border-radius: 2rem; font-size: 0.9rem;">{{ song.uploaded_at|date:"M d, Y" }}</span>
                    <span style="background: var(--bg-card); padding: 0.5rem 1rem; border-radius: 2rem; font-size: 0.9rem;">{{ song.download_count }} downloads</span>
                </div>
                
                <div style="display: flex; gap: 1rem;">
                    <button class="play-btn" style="padding: 0.8rem 1.5rem; border-radius: 2rem; background: var(--accent-primary); color: white; border: none; display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <span class="material-icons">play_arrow</span>
                        Play
                    </button>
                    
                    <a href="{% url 'download_song' song.id %}" class="download-btn" style="padding: 0.8rem 1.5rem; border-radius: 2rem; background: var(--bg-card); color: var(--text-primary); text-decoration: none; display: flex; align-items: center; gap: 0.5rem;">
                        <span class="material-icons">download</span>
                        Download
                    </a>
                    
                    <button class="share-btn" data-platform="webshare" data-url="{{ share_url }}" data-title="{{ song.title }} by {{ song.artist.user.username }}" style="padding: 0.8rem 1.5rem; border-radius: 2rem; background: var(--bg-card); color: var(--text-primary); border: none; display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <span class="material-icons">share</span>
                        Share
                    </button>
                </div>
            </div>
        </div>
        
        <div class="share-section" style="margin-top: 2rem;">
            <h3 style="margin-bottom: 1rem;">Share this song</h3>
            <div style="display: flex; gap: 0.5rem;">
                <button class="share-btn" data-platform="whatsapp" data-url="{{ share_url }}" data-title="{{ song.title }} by {{ song.artist.user.username }}" style="padding: 0.6rem; border-radius: 50%; background: var(--bg-card); border: none; cursor: pointer;">
                    <span class="material-icons">chat</span>
                </button>
                <button class="share-btn" data-platform="facebook" data-url="{{ share_url }}" data-title="{{ song.title }} by {{ song.artist.user.username }}" style="padding: 0.6rem; border-radius: 50%; background: var(--bg-card); border: none; cursor: pointer;">
                    <span class="material-icons">facebook</span>
                </button>
                <button class="share-btn" data-platform="x" data-url="{{ share_url }}" data-title="{{ song.title }} by {{ song.artist.user.username }}" style="padding: 0.6rem; border-radius: 50%; background: var(--bg-card); border: none; cursor: pointer;">
                    <span class="material-icons">link</span>
                </button>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Play button functionality
        document.querySelector('.play-btn').addEventListener('click', function() {
            // This would need to be implemented based on your player
            alert('Play functionality would be implemented here');
        });
        
        // Share buttons
        document.querySelectorAll('.share-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const platform = this.dataset.platform;
                const url = this.dataset.url;
                const title = this.dataset.title;
                
                if (platform === 'webshare' && navigator.share) {
                    navigator.share({
                        title: title,
                        text: `Listen to ${title} on SoundWave Pro!`,
                        url: url
                    });
                } else {
                    // Fallback: Copy to clipboard
                    navigator.clipboard.writeText(url).then(() => {
                        alert('Link copied to clipboard!');
                    });
                }
            });
        });
    });
</script>
{% endblock %}
{% endblock %}